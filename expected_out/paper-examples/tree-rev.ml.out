
bst : pi u8 : (corec t0. [t0 × ◆ × t0 × ◆]), u7 : [].
        (int[()] * int[()]
        --((rec g1.
             (pi u8 : (corec t0. [t0 × ◆ × t0 × ◆]), u7 : [].
               (•
                + ((• + •)
                   + ((• + (• + •))
                      \/ (((• + •) + •)
                          + (•
                             + ((•
                                 + (((• + ((• + •) + (g1)[u8.0, ()])))/
                                     u8.1
                                    + ((• + ((• + •) + (g1)[u8.2, ()])))/
                                       u8.3))
                                + •)))))))))
          [u8, u7]-->
        ftree[u8]) | ((rec g1.
                        (pi u8 : (corec t0. [t0 × ◆ × t0 × ◆]),
                          u7 : [].
                          (•
                           \/ (((g1)[u8.0, ()])/u8.1 + ((g1)[u8.2, ()])/u8.3)))))
                     [u8, u7]
tree_sum : pi u12 : [], u11 : (corec t1. [
                                          t1 × ◆ × t1 × ◆]).
                                          (ftree[u11]
                                          --((rec g2.
                                               (pi u12 : [],
                                                 u11 : (corec t1. [t1
                                                  × ◆ × t1 × ◆]).
                                                 (new u14 : ◆.
                                                   (•
                                                    + (•
                                                       \/ (((•
                                                             + ((•
                                                                 + u11.1->)
                                                                + (g2)[
                                                                  (), 
                                                                  u11.0])))/u14
                                                           + ((•
                                                               + ((•
                                                                   + 
                                                                   u11.3->)
                                                                  + (g2)[
                                                                    (),
                                                                    u11.2]))
                                                              + ((•
                                                                  + u14->)
                                                                 + ((•
                                                                    + 
                                                                    •)
                                                                    + 
                                                                    •))))))))))
                                            [u12, u11]-->
                                          int[()]) | ((rec g2.
                                                        (pi u12 : [],
                                                          u11 : (corec t1. [
                                                          t1
                                                           × ◆
                                                               × t1 × ◆
                                                          ]).
                                                          (new u14 : ◆.
                                                            (•
                                                             \/ (((u11.1->
                                                                   + 
                                                                   (g2)[
                                                                   (), 
                                                                   u11.0]))/u14
                                                                 + ((u11.3->
                                                                    + 
                                                                    (g2)[
                                                                    (),
                                                                    u11.2])
                                                                    + 
                                                                    u14->)))))))
                                                     [u12, u11]
reverse : 
pi u16 : (corec t0. [t0 × ◆ × t0 × ◆]), u15 : (corec t1. [t1
  × ◆ × t1 × ◆]). (ftree[u15]
 --((rec g3.
      (pi u16 : (corec t0. [t0 × ◆ × t0 × ◆]), u15 : (corec t1. [
        t1 × ◆ × t1 × ◆]).
        (•
         + ((• + (• + •))
            \/ (•
                + ((•
                    + (((• + ((• + u15.3->) + (g3)[u16.0, u15.2])))/u16.1
                       + ((• + ((• + u15.1->) + (g3)[u16.2, u15.0])))/
                          u16.3))
                   + •)))))))
   [u16, u15]-->
 ftree[u16]) | ((rec g3.
                  (pi u16 : (corec t0. [t0 × ◆ × t0 × ◆]),
                    u15 : (corec t1. [t1 × ◆ × t1 × ◆]).
                    (•
                     \/ (((u15.3-> + (g3)[u16.0, u15.2]))/u16.1
                         + ((u15.1-> + (g3)[u16.2, u15.0]))/u16.3)))))
               [u16, u15]
 : ftree[u19.1] | (((rec g1.
                                                (pi u8 : (corec t0. [
                                                  t0 × ◆ × t0 × ◆]),
                                                  u7 : [].
                                                  (•
                                                   \/ (((g1)[u8.0, ()])/u8.1
                                                       + ((g1)[u8.2, ()])/
                                                          u8.3)))))
                                             [u19.0, ()]
                                             + ((rec g3.
                                                  (pi u16 : (corec t0. [
                                                    t0 × ◆ × t0 × ◆]),
                                                    u15 : (corec t1. [
                                                    t1 × ◆ × t1 × ◆]).
                                                    (•
                                                     \/ (((u15.3->
                                                           + (g3)[u16.0,
                                                             u15.2]))/
                                                          u16.1
                                                         + ((u15.1->
                                                             + (g3)[u16.2,
                                                               u15.0]))/
                                                            u16.3)))))
                                               [u19.1, u19.0])
